# SQL Analytical Project Report

## ðŸ“Œ Introduction
This project is based on a **movie rental database** containing multiple entities:  
- **Movies**  
- **Actors**  
- **ActsIn (relation between movies and actors)**  
- **Customers**  
- **Renting (transactions of rentals)**  

The purpose of this analysis is to generate business insights using **SQL queries**, such as:  
- Customer behavior  
- Movie popularity  
- Revenue generation  
- Actor involvement  

---

## ðŸ“Š Dataset Schema
- **movies(movie_id, title, genre, runtime, year_of_release, renting_price)**  
- **actors(actor_id, name, year_of_birth, nationality, gender)**  
- **actsin(actsin_id, movie_id, actor_id)**  
- **customers(customer_id, name, country, gender, date_of_birth, date_account_start)**  
- **renting(renting_id, customer_id, movie_id, rating, date_renting)**  

---

## ðŸ”¹ Level 1: Basic Questions & Queries

**Q1. How many movies are in the database?**  
```sql
SELECT COUNT(*) AS total_movies FROM movies;
```

**Q2. What is the average runtime of movies?**  
```sql
SELECT AVG(runtime) AS avg_runtime FROM movies;
```

**Q3. Which genre has the highest number of movies?**  
```sql
SELECT genre, COUNT(*) AS total
FROM movies
GROUP BY genre
ORDER BY total DESC
LIMIT 1;
```

**Q4. How many customers are there in each country?**  
```sql
SELECT country, COUNT(*) AS total_customers
FROM customers
GROUP BY country
ORDER BY total_customers DESC;
```

**Q5. What is the percentage of male vs. female customers?**  
```sql
SELECT gender, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM customers) AS percentage
FROM customers
GROUP BY gender;
```

**Q6. How many actors are in the database?**  
```sql
SELECT COUNT(*) AS total_actors FROM actors;
```

**Q7. What is the oldest movie in the database?**  
```sql
SELECT title, year_of_release
FROM movies
ORDER BY year_of_release ASC
LIMIT 1;
```

---

## ðŸ”¹ Level 2: Intermediate Questions & Queries

**Q1. Who are the top 10 customers with the highest number of rentals?**  
```sql
SELECT c.customer_id, c.name, COUNT(r.renting_id) AS total_rentals
FROM renting r
JOIN customers c ON r.customer_id = c.customer_id
GROUP BY c.customer_id, c.name
ORDER BY total_rentals DESC
LIMIT 10;
```

**Q2. What is the average rating of movies for each genre?**  
```sql
SELECT m.genre, AVG(r.rating) AS avg_rating
FROM renting r
JOIN movies m ON r.movie_id = m.movie_id
GROUP BY m.genre
ORDER BY avg_rating DESC;
```

**Q3. Which movies have been rented the most?**  
```sql
SELECT m.title, COUNT(r.renting_id) AS total_rentals
FROM renting r
JOIN movies m ON r.movie_id = m.movie_id
GROUP BY m.title
ORDER BY total_rentals DESC
LIMIT 10;
```

**Q4. What is the average age of customers when they created their accounts?**  
```sql
SELECT AVG(EXTRACT(YEAR FROM date_account_start) - EXTRACT(YEAR FROM date_of_birth)) AS avg_start_age
FROM customers;
```

**Q5. How many movies feature more than 3 actors?**  
```sql
SELECT m.title, COUNT(a.actor_id) AS num_actors
FROM actsin ac
JOIN movies m ON ac.movie_id = m.movie_id
JOIN actors a ON ac.actor_id = a.actor_id
GROUP BY m.title
HAVING COUNT(a.actor_id) > 3
ORDER BY num_actors DESC;
```

---

## ðŸ”¹ Level 3: Advanced Questions & Queries

**Q1. Who are the actors that most frequently appear in top-rated movies?**  
```sql
SELECT a.name, COUNT(*) AS appearances
FROM renting r
JOIN movies m ON r.movie_id = m.movie_id
JOIN actsin ac ON m.movie_id = ac.movie_id
JOIN actors a ON ac.actor_id = a.actor_id
WHERE r.rating >= 4
GROUP BY a.name
ORDER BY appearances DESC
LIMIT 10;
```

**Q2. What is the total revenue generated by each movie?**  
```sql
SELECT m.title, COUNT(r.renting_id) * m.renting_price AS total_revenue
FROM renting r
JOIN movies m ON r.movie_id = m.movie_id
GROUP BY m.title, m.renting_price
ORDER BY total_revenue DESC;
```

**Q3. Which country generates the highest revenue from movie rentals?**  
```sql
SELECT c.country, SUM(m.renting_price) AS revenue
FROM renting r
JOIN customers c ON r.customer_id = c.customer_id
JOIN movies m ON r.movie_id = m.movie_id
GROUP BY c.country
ORDER BY revenue DESC
LIMIT 1;
```



**Q4. Which customers have not rented any movie in the last 2 years?**  
```sql
SELECT c.customer_id, c.name
FROM customers c
LEFT JOIN renting r ON c.customer_id = r.customer_id
GROUP BY c.customer_id, c.name
HAVING MAX(r.date_renting) < CURRENT_DATE - INTERVAL '2 years';
```

---

## ðŸ“Œ Conclusion
This project demonstrates how SQL can be applied to analyze a movie rental business.  
By writing analytical queries, we can identify customer behaviors, revenue drivers, and popular genres.  
The insights gained from this project can support better decision-making and strategic planning.

